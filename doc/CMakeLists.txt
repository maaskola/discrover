INCLUDE(UseLATEX)

EXECUTE_PROCESS(
  COMMAND ./plasma -h
  WORKING_DIRECTORY "${CMAKE_CURRENT_BINARY_DIR}/../plasma/"
  RESULT_VARIABLE res
  OUTPUT_VARIABLE PLASMA_CLI_HELP_OUTPUT
  # ERROR_QUIET
  OUTPUT_STRIP_TRAILING_WHITESPACE
)

EXECUTE_PROCESS(
  COMMAND ./dlhmm -h
  WORKING_DIRECTORY "${CMAKE_CURRENT_BINARY_DIR}/../"
  RESULT_VARIABLE res
  OUTPUT_VARIABLE DLHMM_CLI_HELP_OUTPUT
  # ERROR_QUIET
  OUTPUT_STRIP_TRAILING_WHITESPACE
)

ADD_LATEX_DOCUMENT(manual.tex
  CONFIGURE manual.tex
  BIBFILES documentation.bib
  # IMAGE_DIRS images
  DEFAULT_PDF
)

ADD_CUSTOM_COMMAND(TARGET pdf POST_BUILD
  COMMAND ${CMAKE_COMMAND} -E copy
  ${CMAKE_CURRENT_BINARY_DIR}/manual.pdf
  ${CMAKE_BINARY_DIR}/doc/${PROJECT_NAME}-manual.pdf
)

INSTALL(FILES ${CMAKE_BINARY_DIR}/doc/${PROJECT_NAME}-manual.pdf
  DESTINATION "${CMAKE_INSTALL_PREFIX}/share/doc/${PROJECT_NAME}"
)
