.\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.45.1.
.TH discrover "1" "January 2015" "discrover 1.5.0 [master branch]" "User Commands"
.SH NAME
discrover \- discriminative motif discovery using hidden Markov models
.SH SYNPOSIS
.B discrover
[
.B options
]
.B -m
.I motifspec
.I filespec
[ \fIfilespec\fR ... ]
.SH DESCRIPTION
This programs helps you discover patterns of binding site in nucleic acids
sequences with discriminative learning. Sets of positive and negative example
sequences are mined for sequence motifs whose occurrence frequency varies
between the sets. Hidden Markov models are used as probabilistic models of the
sequence motifs. The method is applicable to the analysis of genome- and
transcriptome-scale data, such as generated by next-generation sequencing
technologies like ChIP\-Seq or CLIP\-Seq / PAR\-CLIP. It makes use of available
repeat experiments and aside from binary contrasts also more complex data
configurations can be utilized. Several objective functions are available: for
details on these please refer to the description of the \fB\-\-score\fR option.
.TP
The method is described in an open-access publication:
Jonas Maaskola and Nikolaus Rajewsky.
.br
Binding site discovery from nucleic acid sequences by discriminative learning of hidden Markov models.
.br
Nucleic Acid Research, 42(21):12995\-13011, Dec 2014. doi:10.1093/nar/gku1083
.PP
Please note that the software is accompanied by a manual in PDF format which includes recipes for motif discovery for ChIP\-Seq and PAR\-CLIP data.
.PP
Options may also be specified in a configuration file, by using \fB\-\-config\fR.
Options given as arguments on the command line take precedence over configuration file entries.
For options accepted multiple times, parameters from command line and configuration file are joined.
.PP
Various output files are generated, including the resulting parameters, summary information, motif occurrence tables, and the Viterbi parse.
Also, sequence logos of the found motifs are automatically generated.
See the description of the \fB\-\-output\fR option below for details.
.PP
Apart from the description of command line arguments below, advanced usage instructions are given in the manual.
In particular, the manual explains
.IP * 3
how sets of sequences can be grouped into multiple contrasts (useful e.g. when repeat experiments are available),
.IP *
how motifs can be discovered that are discriminative for one contrast but not for another, and
.IP *
how composite models of multiple motifs can be built, which is useful to discover co\-factor motifs e.g. in ChIP\-Seq analysis (in brief: by discovering many seeds and then building composite HMMs using the \fB\-\-multiple\fR switch).
.PP
Manual:
.I @MANUAL_LOCATION@
.\"
.\"
.\"
.\"
.\"
.SS "FASTA file specification"
The syntax of a FASTA file specification is as follows:
.IP
[\fInames\fR:[\fIcontrast\fR:]]\fIpath
.PP
The square brackets indicate that \fInames\fR and \fIcontrast\fR are optional.
.PP
The meaning of  \fInames\fR, \fIcontrast\fR, and \fIpath\fR are as follows:
.TP
.IR names
comma\-separated list of names of motifs enriched in this file
.TP
.IR contrast
name of a contrast this file belongs to
.TP
.IR path
path of FASTA file with sequences
.PP
Using \fIcontrast\fRs, FASTA files can be grouped into contrasts on which
.B score specifications
can act.
If the path contains at least one colon, please prepend with colons to disambiguate.
.\"
.\"
.\"
.\"
.\"
.SS "Motif specification"
The syntax of a motif specification is as follows:
.IP
[\fIname\fR:[\fIinsert\fR]]\fImotifdef
.TP
.I name
name of the motif
.TP
.I insert
comma\-separated list of positions after which to add an insertion state;
positions are 1\-indexed; 1 <= position < motif length must hold for each position
.TP
.I motifdef
motif definition; see below
.PP
The square brackets indicate that \fIname\fR and \fIinsert\fR are optional.
.PP
There are three ways in which a \fImotifdef\fR can be given:
.TP
IUPAC regular expression
Using the IUPAC code for nucleic acids.
.TP
Length specification
Motifs of the indicated lengths are sought.
A length specification is a comma separated list of length ranges, where a length range is either a single length, or an expression of the form 'x\-y' to indicate lengths x up to y.
A length specification also allows to specify a multiplicity separated by an 'x'.
Thus examples are '8' for just length 8, '5\-7' for lengths 5, 6, and 7, '5\-8x2' for two motifs of lengths 5 to 8, '5\-8,10x3' for three motifs of lengths 5, 6, 7, 8, and 10.
.TP
Path to a file with a PWM
If the path contains at least one colon, please prepend colons to disambiguate.
.\"
.\"
.\"
.\"
.\"
.SS "Score specification"
The syntax of a score specification is as follows:
.IP
[\fImotif\fR:[\fIcontrasts\fR:]]\fImeasure\fR
.TP
\fImotif\fR
name of the motif to optimize
.TP
\fIcontrasts\fR
contrast specification; see below
.TP
\fImeasure\fR
significance measure to use
.PP
The square brackets indicate that \fImotif\fR and \fIcontrasts\fR are optional.
.PP
If no motif \fIname\fR is given, all motifs are optimized with this score specification.
It is an error when more than one score specification is given for any motif.
.PP
The contrast specification \fIcontrasts\fR is a set of contrast names prefixed by '+' or '\-' to indicate whether the score on the contrast is to count positively or negatively.
The first contrast name, if lacking a '+' or '\-', is taken to count positively.
If no contrast specification is given, the score definition uses all contrasts, counting each one positively.
.PP
The following significance \fImeasure\fRs are available:
.TP
none
Do not perform learning
.TP
bw
Likelihood maximization with the Baum\-Welch algorithm; this measure is not discriminative
.TP
viterbi
Viterbi learning; this measure is not discriminative
.TP
mi
Mutual information of condition and motif occurrence (MICO)
.TP
ri
Rank mutual information
.TP
mmie
Maximum mutual information estimation (MMIE), also known as posterior classification probability
.TP
mcc
Matthews correlation coefficient
.TP
dlogl
Log\-likelihood difference, like in the motif discovery method DME, see doi: 10.1073/pnas.0406123102
.TP
dfreq
Difference of frequency of sequences with motif occurrences, similar to the motif discovery methods DIPS and DECOD, see doi: 10.1093/bioinformatics/btl227 and 10.1093/bioinformatics/btr412
.\"
.\"
.\"
.\"
.\"
.SS "Output files"
The output files comprise:
.TP
\&.hmm
Parameter of the trained HMM.
May be loaded later with \fB\-\-learn\fR.
.TP
\&.summary
Summary information with number of occurrences of the motifs in each sample, and various generative and discriminative statistics.
.TP
\&.viterbi
FASTA sequences annotated with the Viterbi path, and sequence level statistics.
\&.bed
BED file of coordinates of matches to the motifs in all sequences.
.TP
\&.table
Coordinates and sequences of matches to the motifs in all sequences (extends the .bed output file).
.PP
Note that, depending on the argument of \fB\-\-compress\fR, the latter three files may be compressed, and require decompression for inspection.
Also, sequence logos of the found motifs are generated with file names based on this output label.
.\"
.\"
.\"
.\"
.\"
.SH OPTIONS
.SS "Generic options:"
.TP
\fB\-\-config\fR \fIarg\fR
Read options from a configuration file.
.TP
\fB\-h\fR [ \fB\-\-help\fR ]
Produce help message. Combine with \fB\-v\fR or \fB\-V\fR for
additional commands.
.TP
\fB\-\-version\fR
Print out the version. Also show git SHA1 with \fB\-v\fR.
.TP
\fB\-v\fR [ \fB\-\-verbose\fR ]
Be verbose about the progress.
.TP
\fB\-V\fR [ \fB\-\-noisy\fR ]
Be very verbose about the progress.
.SS "Basic options, required:"
.TP
\fB\-f\fR [ \fB\-\-fasta\fR ] \fIfilespec
.B FASTA file specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
Note: usage of \fB\-f\fR / \fB\-\-fasta\fR is optional;
all free arguments are taken to be paths of FASTA file specifications.
.TP
\fB\-m\fR [ \fB\-\-motif\fR ] \fImotifspec
.B Motif specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
.SS "Basic options:"
.TP
\fB\-\-score\fR \fIscorespec\fR (=mi)
.B Score specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
.TP
\fB\-r\fR [ \fB\-\-revcomp\fR ]
Respect motif occurrences on the reverse complementary strand.
Useful for DNA sequence motif analysis.
Default is to consider only occurrence on the forward strand.
.SS "Advanced options:"
.TP
\fB\-o\fR [ \fB\-\-output\fR ] \fIlabel\fR
Output file names are generated from \fIlabel\fR.
If not given, the output label will be 'discrover_XXX' where XXX is a string to make the label unique.
The generated
.B output files
are described in the section above.
.TP
\fB\-\-threads\fR \fInum\fR
Number of threads.
If not given, as many are used as there are CPU cores on this machine.
.TP
\fB\-\-time\fR
Output information about how long certain parts take to execute.
.TP
\fB\-\-cv\fR \fInum\fR (=0)
Number of cross validation iterations to do.
.TP
\fB\-\-cv_freq\fR \fIfloat\fR (=0.9)
Fraction of data samples for training in cross validation.
.TP
\fB\-\-nseq\fR \fInum\fR (=0)
Use only the first \fInum\fR sequences of each file.
Use 0 to indicate all sequences.
.TP
\fB\-\-iter\fR \fInum\fR (=1000)
Maximal number of iterations to perform in training.
A value of 0 means no limit, and that the training is only terminated by the tolerance.
.TP
\fB\-\-salt\fR \fInum\fR
Seed for the pseudo random number generator (used e.g.  for sequence shuffle generation and MCMC sampling).
Set this to get reproducible results.
.TP
\fB\-\-weight\fR
When combining objective functions across multiple contrasts, combine values by weighting with the number of sequences per contrasts.
.SS "Multiple motif mode options:"
.TP
\fB\-\-multiple\fR
Accept multiple motifs as long as the score increases.
This can only be used with the objective function MICO.
.TP
\fB\-\-relearn\fR \fIarg\fR (=full) When accepting multiple motifs, whether and how to re\-learn the model after a new motif is added.
Choices: 'none', 'reest', 'full'.
.TP
\fB\-\-resratio\fR \fIfloat\fR (=5)
Cutoff to discard new motifs in multi motif mode.
The cutoff is applied on the ratio of conditional mutual information of the new motif and the conditions given the previous motifs.
Must be non\-negative.
High values discard more motifs, and lead to less redundant motifs.
.SS "MMIE options:"
.TP
\fB\-\-classp\fR \fIfloat\fR (=0.5)
Initial class prior.
.TP
\fB\-\-motifp1\fR \fIfloat\fR (=0.6)
Initial conditional motif prior for the signal class.
.HP
\fB\-\-motifp2\fR \fIfloat\fR (=0.03)
Initial conditional motif prior for the control class.
.TP
\fB\-\-noclassp\fR
Don't learn the class prior.
.TP
\fB\-\-nomotifp\fR
Don't learn the conditional motif prior.
.SS "MCMC optimization options:"
.TP
\fB\-\-sampling\fR
Perform Monte\-Carlo Markov chain (MCMC) sampling for parameter inference instead of re\-estimation or gradient learning.
.TP
\fB\-\-temp\fR \fIfloat\fR (=0.001)
When performing MCMC sampling use this temperature.
The temperatures of parallel chains is decreasing by factors of two.
.TP
\fB\-\-smin\fR \fInum\fR
Minimal motif length for MCMC sampling.
When unspecified defaults to initial motif length.
.TP
\fB\-\-smax\fR \fInum\fR
Maximal motif length for MCMC sampling.
When unspecified defaults to initial motif length.
.TP
\fB\-\-nindel\fR \fInum\fR (=5)
Maximal number of positions that may be added or removed at a time.
Adding and removing of happens at and from the ends of the motif.
.TP
\fB\-\-nshift\fR \fInum\fR (=5)
Maximal number of positions that the motif may be shifted by.
.TP
\fB\-\-partemp\fR \fInum\fR (=6)
Number of chains in parallel tempering.
.SS "Seeding options for IUPAC regular expression finding:"
.TP
\fB\-\-seedscore\fR \fIarg\fR (=mi)
Which objective function to evaluate.
TODO: documentation needs updating to reflect more advanced options for this argument.
Available are 'signal_freq', 'control_freq', 'mi', 'mcc', 'delta_freq', 'gtest', 'gtest_logp', 'gtest_logp_raw'.
.TP
\fB\-\-algo\fR \fIarg\fR (=plasma)
Seeding algorithm.
Available are 'plasma', 'mcmc', 'dreme', and 'all'.
Multiple algorithms can be used by separating them by comma.
.TP
\fB\-\-any\fR
Whether to allow motifs enriched in the opposite direction.
.TP
\fB\-\-filter\fR \fIarg\fR (=mask)
How to filter motif occurrences upon identifying a motif.
Available are 'remove' and 'mask'.
.TP
\fB\-\-cand\fR \fInum\fR (=100)
How many candidates to maintain.
.TP
\fB\-\-deg\fR \fInum\fR
Which degrees of degeneracy to consider.
May be given multiple times.
A sequence of length \fIN\fR has a maximal degeneracy of 3*\fIN\fR.
Unlimited if unspecified.
.TP
\fB\-\-rdeg\fR \fIfloat\fR (=1)
Limit relative degeneracy.
1 corresponds to full degeneracy, and 0 to no degeneracy.
For a sequence of length \fIN\fR the degeneracy is maximally 3*\fIN\fR.
Thus for a motif of length 8 a maximal relative degeneracy of 0.2 allows (rounded down) 4 degrees of degeneracy.
.TP
\fB\-\-generalize\fR
Whether to report the best motifs at each level of degeneracy.
Default is to report only the best motif across all levels of degeneracy.
In addition, the best motifs of levels of degeneracy given by \fB\-\-deg\fR will be reported.
.TP
\fB\-\-best\fR
Whether to report only the single best motif for each motif specification.
Default is to report for each motif specification the best result for each length.
.TP
\fB\-\-strict\fR
Do not allow insignificant seeds.
.TP
\fB\-\-fix_mspace\fR
Deactivate dynamic motif space mode.
Influences how the multiple\-testing correction for the log\-p value of the G\-test is calculated.
.TP
\fB\-\-allowIUPAC\fR
Interpret IUPAC wildcard symbols in FASTA files.
When this option is used e.g. S (strong) matches C and G, and so on.
Importantly, N matches any character!
Use non\-IUPAC characters for positions where the sequence is unknown or masked, e.g. you could use '\-' for this.
By default, only A, C, G, and T characters (and their lower case variants) are encoded while all other characters are interpreted as masked.
.SS "Initialization options:"
.TP
\fB\-l\fR [ \fB\-\-load\fR ] \fIarg\fR
Load HMM parameters from a .hmm file produced by an earlier run.
Can be specified multiple times; then the first parameter file will be loaded, and motifs of the following parameter files are added.
.TP
\fB\-\-alpha\fR \fIfloat\fR (=0.03)
Probability of alternative nucleotides.
The nucleotides not included in the IUPAC character will have this probability.
.TP
\fB\-\-lambda\fR \fIfloat\fR (=1)
Initial value for prior with which a motif is expected.
.TP
\fB\-\-wiggle\fR \fInum\fR (=0)
For automatically determined seeds, consider variants shifted up\- and downstream by up to \fInum\fR positions.
.TP
\fB\-\-extend\fR \fInum\fR (=0)
Extend seeds by \fInum\fR Ns up\- and downstream before HMM training.
.TP
\fB\-\-padl\fR \fInum\fR (=0)
Add \fInum\fR Ns upstream (to the left) of the seed.
.TP
\fB\-\-padr\fR \fInum\fR (=0)
Add \fInum\fR Ns downstream (to the right) of the seed.
.SS "Sequence logo creation options:"
.TP
\fB\-\-nopdf\fR
Do not generate PDF files with sequence logos of the found motifs.
.TP
\fB\-\-nopng\fR
Do not generate PNG files with sequence logos of the found motifs.
.TP
\fB\-\-axes\fR
Include axes in sequence logos.
.TP
\fB\-\-logo\fR \fIarg\fR (=info)
Which kind of logo to create; 'info' for information\-type sequence logo (position height scaled by information content), 'freq' for frequency logo.
.TP
\fB\-\-alphabet\fR \fIarg\fR
Which alphabet to use; can be either 'RNA' or 'DNA'.
If left unspecified, 'DNA' is chosen if \fB\-\-revcomp\fR is used, and 'RNA' otherwise.
.TP
\fB\-\-order\fR \fIarg\fR (=freq)
How to vertically order the nucleotides; can be either \&'alpha' for alphabetic order or 'freq' for most frequent at top.
.TP
\fB\-\-pal\fR \fIarg\fR (=default)
Color palette to use; available are 'default', \&'solarized', 'tetrad'.
.TP
\fB\-\-scale\fR \fInum\fR (=100)
Height in pixels of the nucleotide stacks in the sequence logos.
.SS "Hidden options:"
.TP
\fB\-\-nosave\fR
Do not save generated shuffle sequences.
.TP
\fB\-\-bglearn\fR \fIarg\fR (=em)
How to learn the background.
Available are 'fixed', \&'em', 'gradient', where the 'em' uses re\-estimation to maximize the likelihood contribution of the background parameters, while 'gradient' uses the discriminative objective function.
.TP
\fB\-\-pscnt\fR \fIfloat\fR (=1)
The pseudo count to be added to the contingency tables in the discriminative algorithms.
.TP
\fB\-\-pscntE\fR \fIfloat\fR (=1)
The pseudo count to be added to the expected emission probabilities before normalization in the Baum\-Welch algorithm.
.TP
\fB\-\-pscntT\fR \fIfloat\fR (=0)
The pseudo count to be added to the expected transition probabilities before normalization in the Baum\-Welch algorithm.
.TP
\fB\-\-compress\fR \fIarg\fR (=gz)
Compression method for larger output files.
Available are: 'none', 'gz' or 'gzip', 'bz2' or 'bzip2'.
.TP
\fB\-\-miseeding\fR
Disregard automatic seeding choice and use MICO for seeding.
.TP
\fB\-\-absthresh\fR
Whether improvement should be gauged by absolute value.
Default is relative to the current score.
.TP
\fB\-\-intermediate\fR
Write out intermediate parameters during training.
.TP
\fB\-\-limitlogp\fR
Do not report corrected log\-P values greater 0 but report 0 in this case.
.TP
\fB\-\-longnames\fR
Form longer output file names that contain some information about the parameters.
.SS "Line searching options:"
.TP
\fB\-\-LSmu\fR \fIfloat\fR (=0.1)
The parameter mu for the More\-Thuente line search algorithm.
.TP
\fB\-\-LSeta\fR \fIfloat\fR (=0.5)
The parameter eta for the More\-Thuente line search algorithm.
.TP
\fB\-\-LSdelta\fR \fIfloat\fR (=0.66)
The parameter delta for the More\-Thuente line search algorithm.
.TP
\fB\-\-LSnum\fR \fInum\fR (=10)
How many gradient and function evaluation to perform maximally per line search.
.SS "Evaluation options:"
.TP
\fB\-\-posterior\fR
During evaluation also print out the motif posterior probability.
.TP
\fB\-\-condmotif\fR
During evaluation compute for every position the conditional motif likelihood considering only the motif emissions.
.TP
\fB\-\-nosummary\fR
Do not print summary information.
.TP
\fB\-\-noviterbi\fR
Do not print the Viterbi path.
.TP
\fB\-\-nobed\fR
Do not generate BED file with positions of motif occurrences.
.TP
\fB\-\-notable\fR
Do not print the occurrence table.
.TP
\fB\-\-ric\fR
Perform a rank information coefficient analysis.
.SS "Termination options:"
.TP
\fB\-\-gamma\fR \fIfloat\fR (=1e\-4)
Tolerance for the reestimation type learning methods.
Training stops when the L1 norm of the parameter change between iterations is less than this value.
.TP
\fB\-\-delta\fR \fIfloat\fR (=1e\-4)
Relative score difference criterion tolerance for training algorithm termination:
stops iterations when (f \- f') / f < delta, where f' is the objective value of the past iteration, and f is the objective value of the current iteration.
.TP
\fB\-\-epsilon\fR \fIfloat\fR (=0)
Gradient norm criterion tolerance for training algorithm termination:
stops when ||g|| < epsilon * max(1, ||g||), where ||.|| denotes the Euclidean (L2) norm.
.TP
\fB\-\-past\fR \fInum\fR (=1)
Distance for delta\-based convergence test.
This parameter determines the distance, in iterations, to compute the rate of decrease of the objective function.
.\"
.\"
.\"
.\"
.\"
.SH EXAMPLES
In the first example we want to train a motif seeded with the IUPAC string \&'tgtanata' on sequences in the FASTA files signal.fa and control.fa.
Output will be written to files whose file name is prefixed by 'label':
.IP
.B discrover
signal.fa control.fa \fB\-m\fR tgtanata \fB\-o\fR label
.PP
Similarly, to automatically find a motif of length 8 one can use the following:
.IP
.B discrover
signal.fa control.fa \fB\-m\fR 8 \fB\-o\fR label
.PP
When the option \fB\-\-output\fR is not given, a unique output prefix will be automatically generated.
.PP
It is possible to use just a single FASTA file for discriminative sequence analysis.
In this case a control set of sequences will be generated by shuffling the signal sequences:
.IP
.B discrover
signal.fa \fB\-m\fR 8
.PP
Note that names may be given to the motifs to annotate in which of the samples they are respectively expected to be enriched, as the following example demonstrates.
.IP
.B discrover
A:sample1.fa B:sample2.fa \fB\-m\fR A:8 \fB\-m\fR B:6
.PP
Here, A and B are arbitrary labels given to motifs of length 8 and 6 that are to be enriched in sample1 and sample2, respectively.
.\"
.\"
.\"
.\"
.\"
.SH "SEE ALSO"
As part of the Discrover package a PDF manual should have been installed on your system.
You should find it at:
.IP
.I @MANUAL_LOCATION@
.PP
