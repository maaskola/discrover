.TH discrover "1" "January 2015" "discrover @GIT_DESCRIPTION@ [@GIT_BRANCH@ branch]" "User Commands"
.SH NAME
discrover \- discriminative motif discovery using hidden Markov models
.SH SYNPOSIS
.B discrover
[
.B options
]
.B -m
.I motifspec
.I filespec
[ \fIfilespec\fR ... ]
.SH DESCRIPTION
This programs helps you discover binding site patterns in nucleic acids sequences with discriminative learning.
Sets of positive and negative example sequences are mined for sequence motifs whose occurrence frequency varies between the sets.
Hidden Markov models are used as probabilistic models of the sequence motifs.
The method is applicable to the analysis of genome- and transcriptome-scale data, such as generated by next-generation sequencing technologies like ChIP\-Seq or CLIP\-Seq / PAR\-CLIP.
It makes use of available repeat experiments and aside from binary contrasts also more complex data configurations can be utilized.
Several objective functions are available: for details on these please refer to the description of the \fB\-\-score\fR option.
.PP
At least one
.B motif specification
and at least one
.B FASTA file specification
have to be given.
.PP
Contrasts for
.B score specifications
that use discriminative significance measures have to comprise at least two
.B FASTA file specifications\fr,
otherwise sequence shuffles will be generated as control sequences.
.TP
The method is described in an open-access publication:
Jonas Maaskola and Nikolaus Rajewsky.
.br
Binding site discovery from nucleic acid sequences by discriminative learning of hidden Markov models.
.br
Nucleic Acid Research, 42(21):12995\-13011, Dec 2014. doi:10.1093/nar/gku1083
.PP
Please note that the software is accompanied by a manual in PDF format which includes recipes for motif discovery for ChIP\-Seq and PAR\-CLIP data.
Refer to the section
.B SEE ALSO
at the bottom of this man page for the location of the manual.
.PP
Apart from the description of command line arguments below, advanced usage instructions are given in the manual.
In particular, the manual explains
.IP * 3
how sets of sequences can be grouped into multiple contrasts (useful for example when repeat experiments are available),
.IP *
how motifs can be discovered that are discriminative for one contrast but not for another, and
.IP *
how composite models of multiple motifs can be built, which is useful to discover co\-factor motifs for example in ChIP\-Seq analysis (in brief: by discovering many seeds and then building composite HMMs using the \fB\-\-multiple\fR switch).
.PP
Options may also be specified in a configuration file, by using \fB\-\-config\fR.
Options given as arguments on the command line take precedence over configuration file entries.
For options accepted multiple times, parameters from command line and configuration file are joined.
.PP
Various output files are generated, including the resulting parameters, summary information, motif occurrence tables, and the Viterbi parse.
Also, sequence logos of the found motifs are automatically generated.
See the description of the \fB\-\-output\fR option below for details.
.\"
.\"
.\"
.\"
.\"
.SS "FASTA file specification"
FASTA file specifications consist of up to three colon-separated terms, with the following syntax:
.IP
[\fInames\fR:[\fIcontrast\fR:]]\fIpath
.PP
The square brackets indicate that \fInames\fR and \fIcontrast\fR are optional.
.PP
The meaning of \fInames\fR, \fIcontrast\fR, and \fIpath\fR are as follows:
.TP
.IR names
comma\-separated list of names of motifs enriched in this file
.TP
.IR contrast
name of a contrast this file belongs to
.TP
.IR path
path of FASTA file with sequences
.PP
All FASTA files for which no \fIcontrast\fR is given are associated with a common, automatically named contrast.
.PP
Using \fIcontrast\fRs, FASTA files can be grouped into contrasts on which
.B score specifications
can act.
If the path contains at least one colon, please prepend with colons to disambiguate.
.\"
.\"
.\"
.\"
.\"
.SS "Motif specification"
Motif specifications consist of up to three colon-separated terms, with the following syntax:
.IP
[\fIname\fR:[\fIinsert\fR:]]\fImotifdef
.PP
The square brackets indicate that \fIname\fR and \fIinsert\fR are optional.
.PP
The meaning of \fIname\fR, \fIindel\fR, and \fImotifdef\fR are as follows:
.TP
.I name
name of the motif
.TP
.I insert
comma\-separated list of positions after which to add an insertion state;
positions are 1\-indexed; 1 <= position < motif length must hold for each position
.TP
.I motifdef
motif definition; see below
.PP
If \fIname\fR is not given, a name of the form 'motif\fIN\fR' is generated, where \fIN\fR are numbers increasing from 0.
.PP
There are three ways in which a \fImotifdef\fR can be given:
.TP
IUPAC regular expression
Using the IUPAC code for nucleic acids.
.TP
Length specification
Motifs of the indicated lengths are sought.
A length specification is a comma separated list of length ranges, where a length range is either a single length, or an expression of the form 'M\-N' to indicate lengths M up to N.
A length specification also allows to specify a multiplicity separated by an 'x'.
Thus examples are '8' for just length 8, '5\-7' for lengths 5, 6, and 7, '5\-8x2' for two motifs of lengths 5 to 8, '5\-8,10x3' for three motifs of lengths 5, 6, 7, 8, and 10.
.TP
Path to a file with a PWM
If the path contains at least one colon, please prepend colons to disambiguate.
.\"
.\"
.\"
.\"
.\"
.SS "Score specification"
Score specifications consist of up to three colon-separated terms, with the following syntax:
.IP
[\fImotif\fR:[\fIcontrasts\fR:]]\fImeasure\fR
.PP
The square brackets indicate that \fImotif\fR and \fIcontrasts\fR are optional.
.PP
The meaning of \fImotif\fR, \fIcontrasts\fR, and \fImeasure\fR are as follows:
.TP
\fImotif\fR
name of the motif to optimize
.TP
\fIcontrasts\fR
contrast specification; see below
.TP
\fImeasure\fR
significance measure to use
.PP
If \fIname\fR is not given given, all motifs are optimized with this score specification.
It is an error when more than one score specification is given for any motif.
.PP
The contrast specification \fIcontrasts\fR is a set of contrast names prefixed by '+' or '\-' to indicate whether the score on the contrast is to count positively or negatively.
The first contrast name, if lacking a '+' or '\-', is taken to count positively.
If \fIcontrasts\fR is not given, the score definition uses all contrasts, counting each one positively.
.PP
The following significance \fImeasure\fRs are available:
.TP
none
Do not perform learning
.TP
bw
Likelihood maximization with the Baum\-Welch algorithm; this measure is not discriminative
.TP
viterbi
Viterbi learning; this measure is not discriminative
.TP
mi
Mutual information of condition and motif occurrence (MICO)
.TP
ri
Rank mutual information
.TP
mmie
Maximum mutual information estimation (MMIE), also known as posterior classification probability
.TP
mcc
Matthews correlation coefficient
.TP
dlogl
Log\-likelihood difference, like in the motif discovery method DME, see doi: 10.1073/pnas.0406123102
.TP
dfreq
Difference of frequency of sequences with motif occurrences, similar to the motif discovery methods DIPS and DECOD, see doi: 10.1093/bioinformatics/btl227 and 10.1093/bioinformatics/btr412
.\"
.\"
.\"
.\"
.\"
.SS "Output files"
The output files comprise:
.TP
\&.hmm
Parameter of the trained HMM.
May be loaded later with \fB\-\-learn\fR.
.TP
\&.summary
Summary information with number of occurrences of the motifs in each sample, and various generative and discriminative statistics.
.TP
\&.viterbi
FASTA sequences annotated with the Viterbi path, and sequence level statistics.
.TP
\&.bed
BED file of coordinates of matches to the motifs in all sequences.
.TP
\&.table
Coordinates and sequences of matches to the motifs in all sequences (extends the .bed output file).
.PP
Note that, depending on the argument of \fB\-\-compress\fR, the latter three files may be compressed, and require decompression for inspection.
Also, sequence logos of the found motifs are generated with file names based on this output label.
.\"
.\"
.\"
.\"
.\"
.SH OPTIONS
.SS "Generic options:"
.TP
.B \-\-config \fIarg
Read options from a configuration file.
.TP
.B \-h\fR [ \fB\-\-help\fR ]
Produce help message. Combine with \fB\-v\fR or \fB\-V\fR for
additional commands.
.TP
.B \-\-version
Print out the version. Also show git SHA1 with \fB\-v\fR.
.TP
.B \-v\fR [ \fB\-\-verbose\fR ]
Be verbose about the progress.
.TP
.B \-V\fR [ \fB\-\-noisy\fR ]
Be very verbose about the progress.
.SS "Basic options, required:"
.TP
.B \-f\fR [ \fB\-\-fasta\fR ] \fIfilespec
.B FASTA file specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
Note: usage of \fB\-f\fR / \fB\-\-fasta\fR is optional;
all free arguments are taken to be paths of FASTA file specifications.
.TP
.B \-m\fR [ \fB\-\-motif\fR ] \fImotifspec
.B Motif specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
.SS "Basic options:"
.TP
.B \-\-score \fIscorespec\fR (=mi)
.B Score specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
.TP
.B \-r\fR [ \fB\-\-revcomp\fR ]
Respect motif occurrences on the reverse complementary strand.
Useful for DNA sequence motif analysis.
Default is to consider only occurrence on the forward strand.
.SS "Advanced options:"
.TP
.B \-o\fR [ \fB\-\-output\fR ] \fIlabel
Output file names are generated from \fIlabel\fR.
If not given, the output label will be 'discrover_\fIXXX\fR' where \fIXXX\fR is a string to make the label unique.
The generated
.B output files
are described in the section above.
.TP
.B \-\-threads \fInum
Number of threads.
If not given, as many are used as there are CPU cores on this machine.
.TP
.B \-\-time
Output information about how long certain parts take to execute.
.TP
.B \-\-cv \fInum\fR (=0)
Number of cross validation iterations to do.
.TP
.B \-\-cv_freq \fIfloat\fR (=0.9)
Fraction of data samples for training in cross validation.
.TP
.B \-\-nseq \fInum\fR (=0)
Use only the first \fInum\fR sequences of each file.
Use 0 to indicate all sequences.
.TP
.B \-\-iter \fInum\fR (=1000)
Maximal number of iterations to perform in training.
A value of 0 means no limit, and that the training is only terminated by the tolerance.
.TP
.B \-\-salt \fInum
Seed for the pseudo random number generator (used for example for sequence shuffle generation and MCMC sampling).
Set this to get reproducible results.
.TP
.B \-\-weight
When combining objective functions across multiple contrasts, combine values by weighting with the number of sequences per contrasts.
.SS "Multiple motif mode options:"
.TP
.B \-\-multiple
Accept multiple motifs as long as the score increases.
This can only be used with the objective function MICO.
.TP
.B \-\-relearn \fIarg\fR (=full) When accepting multiple motifs, whether and how to re\-learn the model after a new motif is added.
Choices: 'none', 'reest', 'full'.
.TP
.B \-\-resratio \fIfloat\fR (=5)
Cutoff to discard new motifs in multi motif mode.
The cutoff is applied on the ratio of conditional mutual information of the new motif and the conditions given the previous motifs.
Must be non\-negative.
High values discard more motifs, and lead to less redundant motifs.
.SS "MMIE options:"
.TP
.B \-\-classp \fIfloat\fR (=0.5)
Initial class prior.
.TP
.B \-\-motifp1 \fIfloat\fR (=0.6)
Initial conditional motif prior for the signal class.
.HP
.B \-\-motifp2 \fIfloat\fR (=0.03)
Initial conditional motif prior for the control class.
.TP
.B \-\-noclassp
Don't learn the class prior.
.TP
.B \-\-nomotifp
Don't learn the conditional motif prior.
.SS "MCMC optimization options:"
.TP
.B \-\-sampling
Perform Monte\-Carlo Markov chain (MCMC) sampling for parameter inference instead of re\-estimation or gradient learning.
.TP
.B \-\-partemp \fInum\fR (=6)
Number of chains in parallel tempering.
.TP
.B \-\-temp \fIfloat\fR (=0.001)
When performing MCMC sampling use this temperature.
The temperatures of parallel chains is decreasing by factors of two.
.TP
.B \-\-smin \fInum
Minimal motif length for MCMC sampling.
When unspecified defaults to initial motif length.
.TP
.B \-\-smax \fInum
Maximal motif length for MCMC sampling.
When unspecified defaults to initial motif length.
.TP
.B \-\-nindel \fInum\fR (=5)
Maximal number of positions that may be added or removed at a time.
Adding and removing of nucleotides happens in front of and at the ends of the motif.
.TP
.B \-\-nshift \fInum\fR (=5)
Maximal number of positions that the motif may be shifted by.
.SS "Seeding options for IUPAC regular expression finding:"
.TP
.B \-\-seedscore \fIarg\fR (=mi)
Which objective function to evaluate.
Available are 'signal_freq', 'control_freq', 'mi', 'mcc', 'delta_freq', 'gtest', 'gtest_logp', 'gtest_logp_raw'.
.TP
.B \-\-algo \fIarg\fR (=plasma)
Seeding algorithm.
Available are 'plasma', 'mcmc', 'dreme', and 'all'.
Multiple algorithms can be used by separating them by comma.
.TP
.B \-\-any
Whether to allow motifs enriched in the opposite direction.
.TP
.B \-\-filter \fIarg\fR (=mask)
How to filter motif occurrences upon identifying a motif.
Available are 'remove' and 'mask'.
.TP
.B \-\-cand \fInum\fR (=100)
How many candidates to maintain.
.TP
.B \-\-deg \fInum
Which degrees of degeneracy to consider.
May be given multiple times.
A sequence of length \fIN\fR has a maximal degeneracy of 3*\fIN\fR.
Unlimited if unspecified.
.TP
.B \-\-rdeg \fIfloat\fR (=1)
Limit relative degeneracy.
1 corresponds to full degeneracy, and 0 to no degeneracy.
For a sequence of length \fIN\fR the degeneracy is maximally 3*\fIN\fR.
Thus for a motif of length 8 a maximal relative degeneracy of 0.2 allows (rounded down) 4 degrees of degeneracy.
.TP
.B \-\-generalize
Whether to report the best motifs at each level of degeneracy.
Default is to report only the best motif across all levels of degeneracy.
In addition, the best motifs of levels of degeneracy given by \fB\-\-deg\fR will be reported.
.TP
.B \-\-best
Whether to report only the single best motif for each motif specification.
Default is to report for each motif specification the best result for each length.
.TP
.B \-\-strict
Do not allow insignificant seeds.
.TP
.B \-\-fix_mspace
Deactivate dynamic motif space mode.
Influences how the multiple\-testing correction for the log\-p value of the G\-test is calculated.
.TP
.B \-\-allowIUPAC
Interpret IUPAC wildcard symbols in FASTA files.
When this option is used e.g. S (strong) matches C and G, and so on.
Importantly, N matches any character!
Use non\-IUPAC characters for positions where the sequence is unknown or masked, e.g. you could use '\-' for this.
By default, only A, C, G, and T characters (and their lower case variants) are encoded while all other characters are interpreted as masked.
.SS "Initialization options:"
.TP
.B \-l\fR [ \fB\-\-load\fR ] \fIarg
Load HMM parameters from a .hmm file produced by an earlier run.
Can be specified multiple times; then the first parameter file will be loaded, and motifs of the following parameter files are added.
.TP
.B \-\-alpha \fIfloat\fR (=0.03)
Probability of alternative nucleotides.
The nucleotides not included in the IUPAC character will have this probability.
.TP
.B \-\-lambda \fIfloat\fR (=1)
Initial value for prior with which a motif is expected.
.TP
.B \-\-wiggle \fInum\fR (=0)
For automatically determined seeds, consider variants shifted up\- and downstream by up to \fInum\fR positions.
.TP
.B \-\-extend \fInum\fR (=0)
Extend seeds by \fInum\fR Ns up\- and downstream before HMM training.
.TP
.B \-\-padl \fInum\fR (=0)
Add \fInum\fR Ns upstream (to the left) of the seed.
.TP
.B \-\-padr \fInum\fR (=0)
Add \fInum\fR Ns downstream (to the right) of the seed.
.SS "Sequence logo creation options:"
.TP
.B \-\-nopdf
Do not generate PDF files with sequence logos of the found motifs.
.TP
.B \-\-nopng
Do not generate PNG files with sequence logos of the found motifs.
.TP
.B \-\-axes
Include axes in sequence logos.
.TP
.B \-\-logo \fIarg\fR (=info)
Which kind of logo to create; 'info' for information\-type sequence logo (position height scaled by information content), 'freq' for frequency logo.
.TP
.B \-\-alphabet \fIarg
Which alphabet to use; can be either 'RNA' or 'DNA'.
If left unspecified, 'DNA' is chosen if \fB\-\-revcomp\fR is used, and 'RNA' otherwise.
.TP
.B \-\-order \fIarg\fR (=freq)
How to vertically order the nucleotides; can be either \&'alpha' for alphabetic order or 'freq' for most frequent at top.
.TP
.B \-\-pal \fIarg\fR (=default)
Color palette to use; available are 'default', \&'solarized', 'tetrad'.
.TP
.B \-\-scale \fInum\fR (=100)
Height in pixels of the nucleotide stacks in the sequence logos.
.SS "Hidden options:"
.TP
.B \-\-nosave
Do not save generated shuffle sequences.
.TP
.B \-\-bglearn \fIarg\fR (=em)
How to learn the background.
Available are 'fixed', \&'em', 'gradient', where the 'em' uses re\-estimation to maximize the likelihood contribution of the background parameters, while 'gradient' uses the discriminative objective function.
.TP
.B \-\-pscnt \fIfloat\fR (=1)
The pseudo count to be added to the contingency tables in the discriminative algorithms.
.TP
.B \-\-pscntE \fIfloat\fR (=1)
The pseudo count to be added to the expected emission probabilities before normalization in the Baum\-Welch algorithm.
.TP
.B \-\-pscntT \fIfloat\fR (=0)
The pseudo count to be added to the expected transition probabilities before normalization in the Baum\-Welch algorithm.
.TP
.B \-\-compress \fIarg\fR (=gz)
Compression method for larger output files.
Available are: 'none', 'gz' or 'gzip', 'bz2' or 'bzip2'.
.TP
.B \-\-miseeding
Disregard automatic seeding choice and use MICO for seeding.
.TP
.B \-\-absthresh
Whether improvement should be gauged by absolute value.
Default is relative to the current score.
.TP
.B \-\-intermediate
Write out intermediate parameters during training.
.TP
.B \-\-limitlogp
Do not report corrected log\-P values greater 0 but report 0 in this case.
.TP
.B \-\-longnames
Form longer output file names that contain some information about the parameters.
.SS "Line searching options:"
.TP
.B \-\-LSmu \fIfloat\fR (=0.1)
The parameter mu for the More\-Thuente line search algorithm.
.TP
.B \-\-LSeta \fIfloat\fR (=0.5)
The parameter eta for the More\-Thuente line search algorithm.
.TP
.B \-\-LSdelta \fIfloat\fR (=0.66)
The parameter delta for the More\-Thuente line search algorithm.
.TP
.B \-\-LSnum \fInum\fR (=10)
How many gradient and function evaluation to perform maximally per line search.
.SS "Evaluation options:"
.TP
.B \-\-posterior
During evaluation also print out the motif posterior probability.
.TP
.B \-\-condmotif
During evaluation compute for every position the conditional motif likelihood considering only the motif emissions.
.TP
.B \-\-nosummary
Do not print summary information.
.TP
.B \-\-noviterbi
Do not print the Viterbi path.
.TP
.B \-\-nobed
Do not generate BED file with positions of motif occurrences.
.TP
.B \-\-notable
Do not print the occurrence table.
.TP
.B \-\-ric
Perform a rank information coefficient analysis.
.SS "Termination options:"
.TP
.B \-\-gamma \fIfloat\fR (=1e\-4)
Tolerance for the reestimation-type learning methods.
Training stops when the L1 norm of the parameter change between iterations is less than this value.
.TP
.B \-\-delta \fIfloat\fR (=1e\-4)
Relative score difference criterion tolerance for training algorithm termination:
stops iterations when (f \- f') / f < delta, where f' is the objective value of the past iteration, and f is the objective value of the current iteration.
.TP
.B \-\-epsilon \fIfloat\fR (=0)
Gradient norm criterion tolerance for training algorithm termination:
stops when ||g|| < epsilon * max(1, ||g||), where ||.|| denotes the Euclidean (L2) norm.
.TP
.B \-\-past \fInum\fR (=1)
Distance for delta\-based convergence test.
This parameter determines the distance, in iterations, to compute the rate of decrease of the objective function.
.\"
.\"
.\"
.\"
.\"
.SH EXAMPLES
In the first example we want to train a motif seeded with the IUPAC string \&'tgtanata' on sequences in the FASTA files signal.fa and control.fa.
Output will be written to files whose file name is prefixed by 'label':
.IP
.B discrover
signal.fa control.fa \fB\-m\fR tgtanata \fB\-o\fR label
.PP
Similarly, to automatically find a motif of length 8 one can use the following:
.IP
.B discrover
signal.fa control.fa \fB\-m\fR 8 \fB\-o\fR label
.PP
When the option \fB\-\-output\fR is not given, a unique output prefix will be automatically generated.
.PP
It is possible to use just a single FASTA file for discriminative sequence analysis.
In this case a control set of sequences will be generated by shuffling the signal sequences:
.IP
.B discrover
signal.fa \fB\-m\fR 8
.PP
Note that names may be given to the motifs to annotate in which of the samples they are respectively expected to be enriched, as the following example demonstrates.
.IP
.B discrover
A:sample1.fa B:sample2.fa \fB\-m\fR A:8 \fB\-m\fR B:6
.PP
Here, A and B are arbitrary labels given to motifs of length 8 and 6 that are to be enriched in sample1 and sample2, respectively.
.\"
.\"
.\"
.\"
.\"
.SH "SEE ALSO"
As part of the Discrover package a PDF manual should have been installed on your system.
You should find it at:
.IP
.I @MANUAL_LOCATION@
.PP
