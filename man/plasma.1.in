.TH plasma "1" "January 2015" "plasma 1.5.0 [master branch]" "User Commands"
.SH NAME
plasma \- motif discovery for discriminative IUPAC regular expressions
.SH SYNPOSIS
.B plasma
[
.B options
]
.B -m
.I motifspec
.I filespec
[ \fIfilespec\fR ... ]
.SH DESCRIPTION
This programs helps you discover binding site patterns in nucleic acids sequences with discriminative learning.
Sets of positive and negative example sequences are mined for sequence motifs whose occurrence frequency varies between the sets.
IUPAC regular expression are used as models of the sequence motifs.
The method is applicable to the analysis of genome- and transcriptome-scale data, such as generated by next-generation sequencing technologies like ChIP\-Seq or CLIP\-Seq / PAR\-CLIP.
It makes use of available repeat experiments and aside from binary contrasts also more complex data configurations can be utilized.
Several objective functions are available: for details on these please refer to the description of the \fB\-\-score\fR option.
.PP
Plasma runs a progressive algorithm, which in each iteration determines the IUPAC regular expression motif with the highest residual score that is enriched in the signal sequences, accepts it, and masks all occurrences or removes all sequences in which it occurs, before proceeding.
.PP
At least one
.B motif specification
and at least one
.B FASTA file specification
have to be given.
.PP
Contrasts for
.B score specifications
that use discriminative significance measures have to comprise at least two
.B FASTA file specifications\fr,
otherwise sequence shuffles will be generated as control sequences.
.TP
This program is part of the Discrover package described in an open-access publication:
Jonas Maaskola and Nikolaus Rajewsky.
.br
Binding site discovery from nucleic acid sequences by discriminative learning of hidden Markov models.
.br
Nucleic Acid Research, 42(21):12995\-13011, Dec 2014. doi:10.1093/nar/gku1083
.PP
Please note that the software is accompanied by a manual in PDF format which includes recipes for motif discovery for ChIP\-Seq and PAR\-CLIP data.
Refer to the section 
.B SEE ALSO
at the bottom of this man page for the location of the manual.
.PP
Apart from the description of command line arguments below, advanced usage instructions are given in the manual.
In particular, the manual explains
.IP * 3
how sets of sequences can be grouped into multiple contrasts (useful for example when repeat experiments are available),
.IP *
how motifs can be discovered that are discriminative for one contrast but not for another, and
.IP *
how composite models of multiple motifs can be built, which is useful to discover co\-factor motifs for example in ChIP\-Seq analysis (in brief: by discovering many seeds and then building composite HMMs using the \fB\-\-multiple\fR switch).
.PP
Options may also be specified in a configuration file, by using \fB\-\-config\fR.
Options given as arguments on the command line take precedence over configuration file entries.
For options accepted multiple times, parameters from command line and configuration file are joined.
.\"
.\"
.\"
.\"
.\"
.SS "FASTA file specification"
FASTA file specifications consist of up to three colon-separated terms, with the following syntax:
.IP
[\fInames\fR:[\fIcontrast\fR:]]\fIpath
.PP
The square brackets indicate that \fInames\fR and \fIcontrast\fR are optional.
.PP
The meaning of \fInames\fR, \fIcontrast\fR, and \fIpath\fR are as follows:
.TP
.IR names
comma\-separated list of names of motifs enriched in this file
.TP
.IR contrast
name of a contrast this file belongs to
.TP
.IR path
path of FASTA file with sequences
.PP
All FASTA files for which no \fIcontrast\fR is given are associated with a common, automatically named contrast.
.PP
Using \fIcontrast\fRs, FASTA files can be grouped into contrasts on which
.B score specifications
can act.
If the path contains at least one colon, please prepend with colons to disambiguate.
.\"
.\"
.\"
.\"
.\"
.SS "Motif specification"
Motif specifications consist of up to two colon-separated terms, with the following syntax:
.IP
[\fIname\fR:]\fImotifdef
.PP
The square brackets indicate that \fIname\fR is optional.
.PP
The meaning of \fIname\fR and \fImotifdef\fR are as follows:
.TP
.I name
name of the motif
.TP
.I motifdef
motif definition; see below
.PP
If \fIname\fR is not given, a name of the form 'motif\fIN\fR' is generated, where \fIN\fR are numbers increasing from 0.
.PP
There are three ways in which a \fImotifdef\fR can be given:
.TP
IUPAC regular expression
Using the IUPAC code for nucleic acids.
.TP
Length specification
Motifs of the indicated lengths are sought.
A length specification is a comma separated list of length ranges, where a length range is either a single length, or an expression of the form 'x\-y' to indicate lengths x up to y.
A length specification also allows to specify a multiplicity separated by an 'x'.
Thus examples are '8' for just length 8, '5\-7' for lengths 5, 6, and 7, '5\-8x2' for two motifs of lengths 5 to 8, '5\-8,10x3' for three motifs of lengths 5, 6, 7, 8, and 10.
.TP
Path to a file with a PWM
If the path contains at least one colon, please prepend colons to disambiguate.
.\"
.\"
.\"
.\"
.\"
.SS "Score specification"
Score specifications consist of up to three colon-separated terms, with the following syntax:
.IP
[\fImotif\fR:[\fIcontrasts\fR:]]\fImeasure\fR
.PP
The square brackets indicate that \fImotif\fR and \fIcontrasts\fR are optional.
.PP
The meaning of \fImotif\fR, \fIcontrasts\fR, and \fImeasure\fR are as follows:
.TP
\fImotif\fR
name of the motif to optimize
.TP
\fIcontrasts\fR
contrast specification; see below
.TP
\fImeasure\fR
significance measure to use
.PP
If \fIname\fR is not given given, all motifs are optimized with this score specification.
It is an error when more than one score specification is given for any motif.
.PP
The contrast specification \fIcontrasts\fR is a set of contrast names prefixed by '+' or '\-' to indicate whether the score on the contrast is to count positively or negatively.
The first contrast name, if lacking a '+' or '\-', is taken to count positively.
If \fIcontrasts\fR is not given, the score definition uses all contrasts, counting each one positively.
.PP
The following significance \fImeasure\fRs are available:
.TP
signal_freq
Relative occurrence frequency in the signal sequences
.TP
control_freq
Relative occurrence frequency in the control sequences
.TP
mi
Mutual information of condition and motif occurrence (MICO)
.\" .TP
.\" ri
.\" Rank mutual information
.TP
mcc
Matthews correlation coefficient
.TP
dfreq
Difference of frequency of sequences with motif occurrences, similar to the motif discovery methods DIPS and DECOD, see doi: 10.1093/bioinformatics/btl227 and 10.1093/bioinformatics/btr412
.TP
gtest
G-test for association
.TP
gtest_logp
log-P value of G-test for association, corrected for multiple testing
.\"
.\"
.\"
.\"
.\"
.SH OPTIONS
.SS "Basic options:"
.TP
.B \-h\fR [ \fB\-\-help\fR ]
produce help message
.TP
.B \-\-version
Print out the version. Also show git SHA1 with \fB\-v\fR.
.TP
.B \-v\fR [ \fB\-\-verbose\fR ]
Be verbose about the progress.
.TP
.B \-V\fR [ \fB\-\-noisy\fR ]
Be very verbose about the progress.
.SS "IUPAC regular expression finding options:"
.TP
.B \-f\fR [ \fB\-\-fasta\fR ] \fIfilespec
.B FASTA file specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
Note: usage of \fB\-f\fR / \fB\-\-fasta\fR is optional;
all free arguments are taken to be paths of FASTA file specifications.
.TP
.B \-m\fR [ \fB\-\-motif\fR ] \fImotifspec
.B Motif specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
.TP
.B \-\-score \fIscorespec\fR (=mi)
.B Score specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
.TP
.B \-r\fR [ \fB\-\-revcomp\fR ]
Respect motif occurrences on the reverse complementary strand.
Useful for DNA sequence motif analysis.
Default is to consider only occurrence on the forward strand.
.TP
.B \-\-nseq \fInum\fR (=0)
Use only the first \fInum\fR sequences of each file.
Use 0 to indicate all sequences.
.TP
.B \-\-algo \fIarg\fR (=plasma)
Seeding algorithm.
Available are 'plasma', 'mcmc', 'dreme', and 'all'.
Multiple algorithms can be used by separating them by comma.
.TP
.B \-\-any
Whether to allow motifs enriched in the opposite direction.
.TP
.B \-\-filter \fIarg\fR (=mask)
How to filter motif occurrences upon identifying a motif.
Available are 'remove' and 'mask'.
.TP
.B \-\-cand \fInum\fR (=100)
How many candidates to maintain.
.TP
.B \-d\fR [ \fB\-\-deg\fR ] \fInum
Which degrees of degeneracy to consider.
May be given multiple times.
A sequence of length \fIN\fR has a maximal degeneracy of 3*\fIN\fR.
Unlimited if unspecified.
.TP
.B \-\-rdeg \fIfloat\fR (=1)
Limit relative degeneracy.
1 corresponds to full degeneracy, and 0 to no degeneracy.
For a sequence of length \fIN\fR the degeneracy is maximally 3*\fIN\fR.
Thus for a motif of length 8 a maximal relative degeneracy of 0.2 allows (rounded down) 4 degrees of degeneracy.
.TP
.B \-g\fR [ \fB\-\-generalize\fR ]
Whether to report the best motifs at each level of degeneracy.
Default is to report only the best motif across all levels of degeneracy.
In addition, the best motifs of levels of degeneracy given by \fB\-\-deg\fR will be reported.
.TP
.B \-\-best
Whether to report only the single best motif for each motif specification.
Default is to report for each motif specification the best result for each length.
.TP
.B \-\-strict
Do not allow insignificant seeds.
.TP
.B \-\-fix_mspace
Deactivate dynamic motif space mode.
Influences how the multiple\-testing correction for the log\-p value of the G\-test is calculated.
.TP
.B \-\-allowIUPAC
Interpret IUPAC wildcard symbols in FASTA files.
When this option is used e.g. S (strong) matches C and G, and so on.
Importantly, N matches any character!
Use non\-IUPAC characters for positions where the sequence is unknown or masked, e.g. you could use '\-' for this.
By default, only A, C, G, and T characters (and their lower case variants) are encoded while all other characters are interpreted as masked.
.TP
.B \-\-weight
When combining objective functions across multiple contrasts, combine values by weighting with the number of sequences per contrasts.
.TP
.B \-\-pcount \fIfloat\fR (=1)
The number of pseudo counts to add to each cell of contingency tables.
.TP
.B \-w\fR [ \fB\-\-word\fR ]
Perform nucleotide level statistics instead of on sequence level.
.TP
.B \-\-time
Output information about how long certain parts take to execute.
.TP
.B \-\-print
Print out sequences annotated with motif occurrences.
.TP
.B \-\-bed
Generate a BED file with positions of motif occurrence.
.TP
.B \-\-threads \fInum
Number of threads.
If not given, as many are used as there are CPU cores on this machine.
.TP
.B \-o\fR [ \fB\-\-output\fR ] \fIlabel
Output file names are generated from \fIlabel\fR.
If not given, the output label will be 'plasma_\fIXXX\fR' where \fIXXX\fR is a string to make the label unique.
If \fB\-\-pdf\fR or \fB\-png\fR are used, sequence logos of the found motifs are generated with file names based on this output label.
.TP
.B \-\-salt \fInum
Seed for the pseudo random number generator (used for example for sequence shuffle generation and MCMC sampling).
Set this to get reproducible results.
.SS "MCMC optimization options:"
.TP
.B \-\-partemp \fInum\fR (=6)
Parallel chains to run for parallel tempering.
.TP
.B \-\-maxiter \fInum\fR (=1000)
Maximal number of iterations to perform during MCMC seeding.
.TP
.B \-\-temp \fIfloat\fR (=0.001)
When performing MCMC sampling use this temperature.
The temperatures of parallel chains is decreasing by factors of two.
.SS "Sequence logo creation options:"
.TP
.B \-\-pdf
Generate PDF files with sequence logos of the found motifs.
.TP
.B \-\-png
Generate PDF files with sequence logos of the found motifs.
.TP
.B \-\-axes
Include axes in sequence logos.
.TP
.B \-\-logo \fIarg\fR (=info)
Which kind of logo to create; 'info' for information\-type sequence logo (position height scaled by information content), 'freq' for frequency logo.
.TP
.B \-\-alphabet \fIarg
Which alphabet to use; can be either 'RNA' or 'DNA'.
If left unspecified, 'DNA' is chosen if \fB\-\-revcomp\fR is used, and 'RNA' otherwise.
.TP
.B \-\-order \fIarg\fR (=freq)
How to vertically order the nucleotides; can be either \&'alpha' for alphabetic order or 'freq' for most frequent at top.
.TP
.B \-\-pal \fIarg\fR (=default)
Color palette to use; available are 'default', \&'solarized', 'tetrad'.
.TP
.B \-\-scale \fInum\fR (=100)
Height in pixels of the nucleotide stacks in the sequence logos.
.TP
.B \-\-absent \fIfloat\fR (=0.03)
Use this frequency for absent nucleotides when creating logos for IUPAC regular expression motifs.
.SH EXAMPLES
Some example calls:
.IP
.B plasma
signal.fa \fB\-m\fR 8 > analysis.txt
.IP
.B plasma
signal.fa control.fa \fB\-m\fR 8 > analysis.txt
.IP
.B plasma
signal.fa control.fa \fB\-m\fR 4\-12 > analysis.txt
.IP
.B plasma
signal.fa control.fa \fB\-m\fR 4\-12 \fB\-d\fR 0 > analysis.txt
.IP
.B plasma
signal.fa control.fa \fB\-m\fR 4\-12 \fB\-\-score\fR freq \fB\-d\fR 0 > analysis.txt
.IP
.B plasma
signal.fa control.fa \fB\-m\fR 4\-12 \fB\-\-score\fR freq \fB\-d\fR 2 > analysis.txt
.IP
.B plasma
signal.fa control.fa \fB\-m\fR 4\-12 \fB\-d\fR 2 > analysis.txt
.IP
.B plasma
signal.fa control.fa \fB\-m\fR 4\-12 \fB\-\-rdeg\fR 0.2 > analysis.txt
.IP
.B plasma
signal:signal.fa control.fa \fB\-m\fR signal:8 > analysis.txt
.SH "SEE ALSO"
As part of the Discrover package a PDF manual should have been installed on your system.
You should find it at:
.IP
.I @MANUAL_LOCATION@
.PP
