.\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.45.1.
.TH DISCROVER "1" "January 2015" "discrover 1.5.0 [master branch]" "User Commands"
.SH NAME
discrover \- manual page for discrover 1.5.0 [master branch]
.SH DESCRIPTION
discrover 1.5.0
Copyright \(co 2011 Jonas Maaskola
Provided under GNU General Public License Version 3 or later.
See the file COPYING provided with this software for details of the license.
.PP
This programs helps you discover patterns of binding site in nucleic acids
sequences with discriminative learning. Sets of positive and negative example
sequences are mined for sequence motifs whose occurrence frequency varies
between the sets. Hidden Markov models are used as probabilistic models of the
sequence motifs. The method is applicable to the analysis of genome\- and
transcriptome\-scale data, such as generated by next\-generation sequencing
technologies like ChIP\-Seq or CLIP\-Seq / PAR\-CLIP. It makes use of available
repeat experiments and aside from binary contrasts also more complex data
configurations can be utilized. Several objective functions are available: for
details on these please refer to the description of the \fB\-\-score\fR option.
.PP
The method is described in an open\-access publication:
Jonas Maaskola and Nikolaus Rajewsky. Binding site discovery from nucleic acid
sequences by discriminative learning of hidden Markov models
Nucleic Acid Research, 42(21):12995\-13011, Dec 2014. doi:10.1093/nar/gku1083
.PP
Please note that the software is accompanied by a manual in PDF format which
includes recipes for motif discovery for ChIP\-Seq and PAR\-CLIP data.
.PP
How to use this software.
In the first example we want to train a motif seeded with the IUPAC string
\&'tgtanata' on sequences in the FASTA files signal.fa and control.fa. Output will
be written to files whose file name is prefixed by 'label':
.PP
discrover signal.fa control.fa \fB\-m\fR tgtanata \fB\-o\fR label
.PP
Similarly, to automatically find a motif of length 8 one can use the following:
.PP
discrover signal.fa control.fa \fB\-m\fR 8 \fB\-o\fR label
.PP
When the option \fB\-\-output\fR is not given, a unique output prefix will be
automatically generated.
.PP
It is possible to use just a single FASTA file for discriminative sequence
analysis. In this case a control set of sequences will be generated by shuffling
the signal sequences:
.PP
discrover signal.fa \fB\-m\fR 8
.PP
Note that names may be given to the motifs to annotate in which of the samples
they are respectively expected to be enriched, as the following example
demonstrates.
.PP
discrover A:sample1.fa B:sample2.fa \fB\-m\fR A:8 \fB\-m\fR B:6
.PP
Here, A and B are arbitrary labels given to motifs of length 8 and 6 that are to
be enriched in sample1 and sample2, respectively.
.PP
Options may also be specified in a configuration file, by using \fB\-\-config\fR.
Options given as arguments on the command line take precedence over
configuration file entries. For options accepted multiple times, parameters from
command line and configuration file are joined.
.PP
Various output files are generated, including the resulting parameters, summary
information, motif occurrence tables, and the Viterbi parse. Also, sequence
logos of the found motifs are automatically generated. See the description of
the \fB\-\-output\fR option below for details.
.PP
Apart from the description of command line arguments below, advanced usage
instructions are given in the manual. In particular, the manual explains
a) how sets of sequences can be grouped into multiple contrasts (useful e.g.
when repeat experiments are available),
b) how motifs can be discovered that are discriminative for one contrast but not
for another, and
c) how composite models of multiple motifs can be built, which is useful to
discover co\-factor motifs e.g. in ChIP\-Seq analysis (in brief: by discovering
many seeds and then building composite HMMs using the \fB\-\-multiple\fR switch).
.PP
Manual: \fI\,/home/maaskola/local/share/doc/discrover/discrover\-manual.pdf\/\fP
.SS "Generic options:"
.TP
\fB\-\-config\fR arg
Read options from a configuration file.
.TP
\fB\-h\fR [ \fB\-\-help\fR ]
Produce help message. Combine with \fB\-v\fR or \fB\-V\fR for
additional commands.
.TP
\fB\-\-version\fR
Print out the version. Also show git SHA1 with \fB\-v\fR.
.TP
\fB\-v\fR [ \fB\-\-verbose\fR ]
Be verbose about the progress.
.TP
\fB\-V\fR [ \fB\-\-noisy\fR ]
Be very verbose about the progress.
.SS "Basic options, required:"
.TP
\fB\-f\fR [ \fB\-\-fasta\fR ] arg
FASTA file definition. May be given multiple times.
Syntax as follows:
.IP
[NAMES:[CONTRAST:]]PATH
.TP
NAMES
comma\-separated list of names of motifs
enriched in this file
.TP
CONTRAST name of a contrast this file belongs to
PATH     path of FASTA file with sequences
.IP
NAMES and CONTRAST are optional.
.TP
FASTA files can be grouped into contrasts on which the
\fB\-\-score\fR definitions (see below) can act.
.TP
If the path contains at least one colon, please prepend
with colons to disambiguate.
.TP
Note: usage of \fB\-f\fR / \fB\-\-fasta\fR is optional; all free
arguments are taken to be paths of FASTA files.
.TP
\fB\-m\fR [ \fB\-\-motif\fR ] arg
Motif definition. May be given multiple times. Syntax
as follows:
.IP
[NAME:[INSERT:]]MOTIFSPEC
.TP
NAME
name of the motif
.TP
INSERT
positions after which insertions are allowed
.IP
MOTIFSPEC motif specification; see below
.IP
NAME and INSERT are optional.
.TP
The INSERT string is a comma\-separated list of
positions after which to add an insertion state.
1\-indexed; 1 ??? position < motif length must hold for
each position.
.TP
MOTIFSPEC can be given in multiple ways:
1. Using the IUPAC code for nucleic acids.
2. A length specification. Motifs of the indicated
.TP
lengths are sought. A length specification is a
comma separated list of length ranges, where a
length range is either a single length, or an
expression of the form 'x\-y' to indicate lengths x
up to y. A length specification also allows to
specify a multiplicity separated by an 'x'. Thus
examples are '8' for just length 8, '5\-7' for
lengths 5, 6, and 7, '5\-8x2' for two motifs of
lengths 5 to 8, '5\-8,10x3' for three motifs of
lengths 5, 6, 7, 8, and 10.
.TP
3. By specifying the path to a file with a PWM. If the
path contains at least one colon, please prepend
colons to disambiguate.
.SS "Basic options:"
.TP
\fB\-\-score\fR arg (=mi)
Score definition. May be given multiple times. Syntax
as follows:
.IP
[MOTIF:[CONTRASTS:]]MEASURE
.TP
MOTIF
name of the motif to optimize
.TP
CONTRASTS contrast specification
MEASURE   significance measure to use
See below for details.
.IP
MOTIF and CONTRASTS are optional.
.TP
If no motif name is given, all motifs are optimized
with this score specification. It is an error when more
than one score specification is given for any motif.
.TP
The contrast specification is a set of contrast names
prefixed by '+' or '\-' to indicate whether the score on
the contrast is to count positively or negatively. The
first contrast name, if lacking a '+' or '\-', is taken
to count positively.
.TP
The following significance measures are available:
none    Do not perform learning
bw      Likelihood using Baum\-Welch
viterbi Viterbi learning
mi      Mutual information of condition and motif
.TP
occurrence (MICO)
ri      Rank mutual information
mmie    Maximum mutual information estimation (MMIE),
.TP
a.k.a. posterior classification probability
mcc     Matthews correlation coefficient
dlogl   Log\-likelihood difference, like DME, see doi:
.TP
10.1073/pnas.0406123102
dfreq   Difference of frequency of sequences with motif
.TP
occurrences, similar to DIPS and DECOD, see
doi: 10.1093/bioinformatics/btl227 and
10.1093/bioinformatics/btr412
.TP
\fB\-r\fR [ \fB\-\-revcomp\fR ]
Respect motif occurrences on the reverse complementary
strand. Useful for DNA sequence motif analysis. Default
is to consider only occurrence on the forward strand.
.SS "Advanced options:"
.TP
\fB\-o\fR [ \fB\-\-output\fR ] arg
Output file names are generated from this label. If not
given, the output label will be 'discrover_XXX' where
XXX is a string to make the label unique. The output
files comprise:
\&.hmm     Parameter of the trained HMM. May be loaded
.TP
later with \fB\-\-learn\fR.
\&.summary Summary information with number of occurrences
.TP
of the motifs in each sample, and various
generative and discriminative statistics.
.TP
\&.viterbi FASTA sequences annotated with the Viterbi
path, and sequence level statistics.
.TP
\&.bed
BED file of coordinates of matches to the
motifs in all sequences.
.TP
\&.table
Coordinates and sequences of matches to the
motifs in all sequences (extends the .bed
output file).
.TP
Note that, depending on the argument of \fB\-\-compress\fR, the
latter three files may be compressed, and require
decompression for inspection.
Also, sequence logos of the found motifs are generated
with file names based on this output label.
.TP
\fB\-\-threads\fR arg
Number of threads. If not given, as many are used as
there are CPU cores on this machine.
.TP
\fB\-\-time\fR
Output information about how long certain parts take to
execute.
.TP
\fB\-\-cv\fR arg (=0)
Number of cross validation iterations to do.
.TP
\fB\-\-cv_freq\fR arg (=0.9)
Fraction of data samples for training in cross
validation.
.TP
\fB\-\-nseq\fR arg (=0)
Use only the first N sequences of each file. Use 0 to
indicate all sequences.
.TP
\fB\-\-iter\fR arg (=1000)
Maximal number of iterations to perform in training. A
value of 0 means no limit, and that the training is
only terminated by the tolerance.
.TP
\fB\-\-salt\fR arg
Seed for the pseudo random number generator (used e.g.
for sequence shuffle generation and MCMC sampling). Set
this to get reproducible results.
.TP
\fB\-\-weight\fR
When combining objective functions across multiple
contrasts, combine values by weighting with the number
of sequences per contrasts.
.SS "Multiple motif mode options:"
.TP
\fB\-\-multiple\fR
Accept multiple motifs as long as the score increases.
This can only be used with the objective function MICO.
.TP
\fB\-\-relearn\fR arg (=full) When accepting multiple motifs, whether and how to
re\-learn the model after a new motif is added. Choices:
\&'none', 'reest', 'full'.
.TP
\fB\-\-resratio\fR arg (=5)
Cutoff to discard new motifs in multi motif mode. The
cutoff is applied on the ratio of conditional mutual
information of the new motif and the conditions given
the previous motifs. Must be non\-negative. High values
discard more motifs, and lead to less redundant motifs.
.SS "MMIE options:"
.TP
\fB\-\-classp\fR arg (=0.5)
Initial class prior.
.TP
\fB\-\-motifp1\fR arg (=0.6)
Initial conditional motif prior for the signal class.
.HP
\fB\-\-motifp2\fR arg (=0.03) Initial conditional motif prior for the control class.
.TP
\fB\-\-noclassp\fR
Don't learn the class prior.
.TP
\fB\-\-nomotifp\fR
Don't learn the conditional motif prior.
.SS "MCMC optimization options:"
.TP
\fB\-\-sampling\fR
Perform Monte\-Carlo Markov chain (MCMC) sampling for
parameter inference instead of re\-estimation or
gradient learning.
.TP
\fB\-\-temp\fR arg (=0.001)
When performing MCMC sampling use this temperature. The
temperatures of parallel chains is decreasing by
factors of two.
.TP
\fB\-\-smin\fR arg
Minimal motif length for MCMC sampling. When
unspecified defaults to initial motif length.
.TP
\fB\-\-smax\fR arg
Maximal motif length for MCMC sampling. When
unspecified defaults to initial motif length.
.TP
\fB\-\-nindel\fR arg (=5)
Maximal number of positions that may be added or
removed at a time. Adding and removing of happens at
and from the ends of the motif.
.TP
\fB\-\-nshift\fR arg (=5)
Maximal number of positions that the motif may be
shifted by.
.TP
\fB\-\-partemp\fR arg (=6)
Number of chains in parallel tempering.
.SS "Seeding options for IUPAC regular expression finding:"
.TP
\fB\-\-seedscore\fR arg (=mi) Which objective function to evaluate. TODO:
documentation needs updating to reflect more advanced
options for this argument. Available are 'signal_freq',
\&'control_freq', 'mi', 'mcc', 'delta_freq', 'gtest',
\&'gtest_logp', 'gtest_logp_raw'.
.TP
\fB\-\-algo\fR arg (=plasma)
Seeding algorithm. Available are 'plasma', 'mcmc',
\&'dreme', and 'all'. Multiple algorithms can be used by
separating them by comma.
.TP
\fB\-\-any\fR
Whether to allow motifs enriched in the opposite
direction.
.TP
\fB\-\-filter\fR arg (=mask)
How to filter motif occurrences upon identifying a
motif. Available are 'remove' and 'mask'.
.TP
\fB\-\-cand\fR arg (=100)
How many candidates to maintain.
.TP
\fB\-\-deg\fR arg
Which degrees of degeneracy to consider. May be given
multiple times. A sequence of length N has a maximal
degeneracy of 3*N. Unlimited if unspecified.
.TP
\fB\-\-rdeg\fR arg (=1)
Limit relative degeneracy. 1 corresponds to full
degeneracy, and 0 to no degeneracy. For a sequence of
length N the degeneracy is maximally 3*N. Thus for a
motif of length 8 a maximal relative degeneracy of 0.2
allows (rounded down) 4 degrees of degeneracy.
.TP
\fB\-\-generalize\fR
Whether to report the best motifs at each level of
degeneracy. Default is to report only the best motif
across all levels of degeneracy. In addition, the best
motifs of levels of degeneracy given by \fB\-\-deg\fR will be
reported.
.TP
\fB\-\-best\fR
Whether to report only the single best motif for each
motif specification.  Default is to report for each
motif specification the best result for each length.
.TP
\fB\-\-strict\fR
Do not allow insignificant seeds.
.TP
\fB\-\-fix_mspace\fR
Deactivate dynamic motif space mode. Influences how the
multiple\-testing correction for the log\-p value of the
G\-test is calculated.
.TP
\fB\-\-allowIUPAC\fR
Interpret IUPAC wildcard symbols in FASTA files. When
this option is used e.g. S (strong) matches C and G,
and so on. Importantly, N matches any character! Use
non\-IUPAC characters for positions where the sequence
is unknown or masked, e.g. you could use '\-' for this.
By default, only A, C, G, and T characters (and their
lower case variants) are encoded while all other
characters are interpreted as masked.
.SS "Initialization options:"
.TP
\fB\-l\fR [ \fB\-\-load\fR ] arg
Load HMM parameters from a .hmm file produced by an
earlier run. Can be specified multiple times; then the
first parameter file will be loaded, and motifs of the
following parameter files are added.
.TP
\fB\-\-alpha\fR arg (=0.03)
Probability of alternative nucleotides. The nucleotides
not included in the IUPAC character will have this
probability.
.TP
\fB\-\-lambda\fR arg (=1)
Initial value for prior with which a motif is expected.
.TP
\fB\-\-wiggle\fR arg (=0)
For automatically determined seeds, consider variants
shifted up\- and downstream by up to the specified
number of positions.
.TP
\fB\-\-extend\fR arg (=0)
Extend seeds by this many Ns up\- and downstream before
HMM training.
.TP
\fB\-\-padl\fR arg (=0)
Add this many Ns upstream (to the left) of the seed.
.TP
\fB\-\-padr\fR arg (=0)
Add this many Ns downstream (to the right) of the seed.
.SS "Sequence logo creation options:"
.TP
\fB\-\-nopdf\fR
Do not generate PDF files with sequence logos of the
found motifs.
.TP
\fB\-\-nopng\fR
Do not generate PNG files with sequence logos of the
found motifs.
.TP
\fB\-\-axes\fR
Include axes in sequence logos.
.TP
\fB\-\-logo\fR arg (=info)
Which kind of logo to create; 'info' for
information\-type sequence logo (position height scaled
by information content), 'freq' for frequency logo.
.TP
\fB\-\-alphabet\fR arg
Which alphabet to use; can be either 'RNA' or 'DNA'. If
left unspecified, 'DNA' is chosen if \fB\-\-revcomp\fR is used,
and 'RNA' otherwise.
.TP
\fB\-\-order\fR arg (=freq)
How to vertically order the nucleotides; can be either
\&'alpha' for alphabetic order or 'freq' for most
frequent at top.
.TP
\fB\-\-pal\fR arg (=default)
Color palette to use; available are 'default',
\&'solarized', 'tetrad'.
.TP
\fB\-\-scale\fR arg (=100)
Height in pixels of the nucleotide stacks in the
sequence logos.
.SS "Hidden options:"
.TP
\fB\-\-nosave\fR
Do not save generated shuffle sequences.
.TP
\fB\-\-bglearn\fR arg (=em)
How to learn the background. Available are 'fixed',
\&'em', 'gradient', where the 'em' uses re\-estimation to
maximize the likelihood contribution of the background
parameters, while 'gradient' uses the discriminative
objective function.
.TP
\fB\-\-pscnt\fR arg (=1)
The pseudo count to be added to the contingency tables
in the discriminative algorithms.
.TP
\fB\-\-pscntE\fR arg (=1)
The pseudo count to be added to the expected emission
probabilities before normalization in the Baum\-Welch
algorithm.
.TP
\fB\-\-pscntT\fR arg (=0)
The pseudo count to be added to the expected transition
probabilities before normalization in the Baum\-Welch
algorithm.
.TP
\fB\-\-compress\fR arg (=gz)
Compression method for larger output files. Available
are: 'none', 'gz' or 'gzip', 'bz2' or 'bzip2'.
.TP
\fB\-\-miseeding\fR
Disregard automatic seeding choice and use MICO for
seeding.
.TP
\fB\-\-absthresh\fR
Whether improvement should be gauged by absolute value.
Default is relative to the current score.
.TP
\fB\-\-intermediate\fR
Write out intermediate parameters during training.
.TP
\fB\-\-limitlogp\fR
Do not report corrected log\-P values greater 0 but
report 0 in this case.
.TP
\fB\-\-longnames\fR
Form longer output file names that contain some
information about the parameters.
.SS "Line searching options:"
.TP
\fB\-\-LSmu\fR arg (=0.1)
The parameter ?? for the Mor??\-Thuente line search
algorithm.
.TP
\fB\-\-LSeta\fR arg (=0.5)
The parameter ?? for the Mor??\-Thuente line search
algorithm.
.TP
\fB\-\-LSdelta\fR arg (=0.66) The parameter delta for the Mor??\-Thuente line search
algorithm.
.TP
\fB\-\-LSnum\fR arg (=10)
How many gradient and function evaluation to perform
maximally per line search.
.SS "Evaluation options:"
.TP
\fB\-\-posterior\fR
During evaluation also print out the motif posterior
probability.
.TP
\fB\-\-condmotif\fR
During evaluation compute for every position the
conditional motif likelihood considering only the motif
emissions.
.TP
\fB\-\-nosummary\fR
Do not print summary information.
.TP
\fB\-\-noviterbi\fR
Do not print the Viterbi path.
.TP
\fB\-\-nobed\fR
Do not generate BED file with positions of motif
occurrences.
.TP
\fB\-\-notable\fR
Do not print the occurrence table.
.TP
\fB\-\-ric\fR
Perform a rank information coefficient analysis.
.SS "Termination options:"
.TP
\fB\-\-gamma\fR arg (=1e\-4)
Tolerance for the reestimation type learning methods.
Training stops when the L1 norm of the parameter change
between iterations is less than this value.
.TP
\fB\-\-delta\fR arg (=1e\-4)
Relative score difference criterion tolerance for
training algorithm termination: stops iterations when
(f \- f') / f < delta, where f' is the objective value
of the past iteration, and f is the objective value of
the current iteration.
.TP
\fB\-\-epsilon\fR arg (=0)
Gradient norm criterion tolerance for training
algorithm termination: stops when ||g|| < epsilon *
max(1, ||g||), where ||.|| denotes the Euclidean (L2)
norm.
.TP
\fB\-\-past\fR arg (=1)
Distance for delta\-based convergence test. This
parameter determines the distance, in iterations, to
compute the rate of decrease of the objective function.
.SH "SEE ALSO"
The full documentation for
.B discrover
is maintained as a Texinfo manual.  If the
.B info
and
.B discrover
programs are properly installed at your site, the command
.IP
.B info discrover
.PP
should give you access to the complete manual.
