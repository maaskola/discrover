.\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.45.1.
.TH plasma "1" "January 2015" "plasma 1.5.0 [master branch]" "User Commands"
.SH NAME
plasma \- motif discovery for discriminative IUPAC regular expressions
.SH SYNPOSIS
.B plasma
[
.B options
]
.B -m
.I motifspec
.I filespec
[ \fIfilespec\fR ... ]
.SH DESCRIPTION
This program runs a progressive algorithm, which in each iteration determines the IUPAC regular expression motif with the highest residual score that is enriched in the signal sequences, accepts it, and masks all occurrences or removes all sequences in which it occurs, before proceeding.
.PP
At least one
.B motif specification
and at least one
.B FASTA file specification
have to be given.
.PP
Contrasts for
.B score specifications
that use discriminative significance measures have to comprise at least two
.B FASTA file specifications\fr,
otherwise sequence shuffles will be generated as control sequences.
.\"
.\"
.\"
.\"
.\"
.SH FASTA file specification
The syntax of a FASTA file specification is as follows:
.IP
[\fInames\fR:[\fIcontrast\fR:]]\fIpath
.PP
The square brackets indicate that \fInames\fR and \fIcontrast\fR are optional.
.PP
The meaning of  \fInames\fR, \fIcontrast\fR, and \fIpath\fR are as follows:
.TP
.IR names
comma\-separated list of names of motifs enriched in this file
.TP
.IR contrast
name of a contrast this file belongs to
.TP
.IR path
path of FASTA file with sequences
.PP
Using \fIcontrast\fRs, FASTA files can be grouped into contrasts on which
.B score specifications
can act.
If the path contains at least one colon, please prepend with colons to disambiguate.
.\"
.\"
.\"
.\"
.\"
.SH Motif specification
The syntax of a motif specification is as follows:
.IP
[\fIname\fR:]\fImotifdef
.TP
.I name
name of the motif
.TP
.I motifdef
motif definition; see below
.PP
The square brackets indicate that \fIname\fR is optional.
.PP
There are three ways in which a \fImotifdef\fR can be given:
.TP
IUPAC regular expression
Using the IUPAC code for nucleic acids.
.TP
Length specification
Motifs of the indicated lengths are sought.
A length specification is a comma separated list of length ranges, where a length range is either a single length, or an expression of the form 'x\-y' to indicate lengths x up to y.
A length specification also allows to specify a multiplicity separated by an 'x'.
Thus examples are '8' for just length 8, '5\-7' for lengths 5, 6, and 7, '5\-8x2' for two motifs of lengths 5 to 8, '5\-8,10x3' for three motifs of lengths 5, 6, 7, 8, and 10.
.TP
Path to a file with a PWM
If the path contains at least one colon, please prepend colons to disambiguate.
.\"
.\"
.\"
.\"
.\"
.SH Score specification
The syntax of a score specification is as follows:
.IP
[\fImotif\fR:[\fIcontrasts\fR:]]\fImeasure\fR
.TP
\fImotif\fR
name of the motif to optimize
.TP
\fIcontrasts\fR
contrast specification; see below
.TP
\fImeasure\fR
significance measure to use
.PP
The square brackets indicate that \fImotif\fR and \fIcontrasts\fR are optional.
.PP
If no motif \fIname\fR is given, all motifs are optimized with this score specification.
It is an error when more than one score specification is given for any motif.
.PP
The contrast specification \fIcontrasts\fR is a set of contrast names prefixed by '+' or '\-' to indicate whether the score on the contrast is to count positively or negatively.
The first contrast name, if lacking a '+' or '\-', is taken to count positively.
If no contrast specification is given, the score definition uses all contrasts, counting each one positively.
.PP
The following significance \fImeasure\fRs are available:
.TP
none
Do not perform learning
.TP
bw
Likelihood maximization with the Baum\-Welch algorithm; this measure is not discriminative
.TP
viterbi
Viterbi learning; this measure is not discriminative
.TP
mi
Mutual information of condition and motif occurrence (MICO)
.TP
ri
Rank mutual information
.TP
mmie
Maximum mutual information estimation (MMIE), also known as posterior classification probability
.TP
mcc
Matthews correlation coefficient
.TP
dlogl
Log\-likelihood difference, like in the motif discovery method DME, see doi: 10.1073/pnas.0406123102
.TP
dfreq
Difference of frequency of sequences with motif occurrences, similar to the motif discovery methods DIPS and DECOD, see doi: 10.1093/bioinformatics/btl227 and 10.1093/bioinformatics/btr412
.SS "Basic options:"
.TP
\fB\-h\fR [ \fB\-\-help\fR ]
produce help message
.TP
\fB\-\-version\fR
Print out the version. Also show git SHA1 with \fB\-v\fR.
.TP
\fB\-v\fR [ \fB\-\-verbose\fR ]
Be verbose about the progress
.TP
\fB\-V\fR [ \fB\-\-noisy\fR ]
Be very verbose about the progress
.SS "IUPAC regular expression finding options:"
.TP
\fB\-f\fR [ \fB\-\-fasta\fR ] \fIfilespec
.B FASTA file specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
Note: usage of \fB\-f\fR / \fB\-\-fasta\fR is optional;
all free arguments are taken to be paths of FASTA file specifications.
.TP
\fB\-m\fR [ \fB\-\-motif\fR ] \fImotifspec
.B Motif specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
.TP
\fB\-\-score\fR \fIscorespec\fR (=mi)
.B Score specification\fR.
May be given multiple times.
See the section above for the allowed syntax.
.TP
\fB\-r\fR [ \fB\-\-revcomp\fR ]
Respect motif occurrences on the reverse complementary strand.
Useful for DNA sequence motif analysis.
Default is to consider only occurrence on the forward strand.
.TP
\fB\-\-nseq\fR \fInum\fR (=0)
Use only the first \fInum\fR sequences of each file.
Use 0 to indicate all sequences.
.TP
\fB\-\-algo\fR \fIarg\fR (=plasma)
Seeding algorithm.
Available are 'plasma', 'mcmc', 'dreme', and 'all'.
Multiple algorithms can be used by separating them by comma.
.TP
\fB\-\-any\fR
Whether to allow motifs enriched in the opposite direction.
.TP
\fB\-\-filter\fR \fIarg\fR (=mask)
How to filter motif occurrences upon identifying a motif.
Available are 'remove' and 'mask'.
.TP
\fB\-\-cand\fR \fInum\fR (=100)
How many candidates to maintain.
.TP
\fB\-d\fR [ \fB\-\-deg\fR ] \fInum\fR
Which degrees of degeneracy to consider.
May be given multiple times.
A sequence of length N has a maximal degeneracy of 3*N.
Unlimited if unspecified.
.TP
\fB\-\-rdeg\fR \fIfloat\fR (=1)
Limit relative degeneracy.
1 corresponds to full degeneracy, and 0 to no degeneracy.
For a sequence of length N the degeneracy is maximally 3*N.
Thus for a motif of length 8 a maximal relative degeneracy of 0.2 allows (rounded down) 4 degrees of degeneracy.
.TP
\fB\-g\fR [ \fB\-\-generalize\fR ]
Whether to report the best motifs at each level of degeneracy.
Default is to report only the best motif across all levels of degeneracy.
In addition, the best motifs of levels of degeneracy given by \fB\-\-deg\fR will be reported.
.TP
\fB\-\-best\fR
Whether to report only the single best motif for each motif specification.
Default is to report for each motif specification the best result for each length.
.TP
\fB\-\-strict\fR
Do not allow insignificant seeds.
.TP
\fB\-\-fix_mspace\fR
Deactivate dynamic motif space mode.
Influences how the multiple\-testing correction for the log\-p value of the G\-test is calculated.
.TP
\fB\-\-allowIUPAC\fR
Interpret IUPAC wildcard symbols in FASTA files.
When this option is used e.g. S (strong) matches C and G, and so on.
Importantly, N matches any character!
Use non\-IUPAC characters for positions where the sequence is unknown or masked, e.g. you could use '\-' for this.
By default, only A, C, G, and T characters (and their lower case variants) are encoded while all other characters are interpreted as masked.
.TP
\fB\-\-weight\fR
When combining objective functions across multiple contrasts, combine values by weighting with the number of sequences per contrasts.
.TP
\fB\-\-pcount\fR \fIfloat\fR (=1)
The number of pseudo counts to add to each cell of contingency tables.
.TP
\fB\-w\fR [ \fB\-\-word\fR ]
Perform nucleotide level statistics instead of on sequence level.
.TP
\fB\-\-time\fR
Output information about how long certain parts take to execute.
.TP
\fB\-\-print\fR
Print out sequences annotated with motif occurrences.
.TP
\fB\-\-bed\fR
Generate a BED file with positions of motif occurrence.
.TP
\fB\-\-threads\fR \fInum\fR
Number of threads.
If not given, as many are used as there are CPU cores on this machine.
.TP
\fB\-o\fR [ \fB\-\-output\fR ] \fIarg\fR
Output file names are generated from this label.
If not given, the output label will be 'plasma_XXX' where XXX is a string to make the label unique.
If \fB\-\-pdf\fR or \fB\-png\fR are used, sequence logos of the found motifs are generated with file names based on this output label.
.TP
\fB\-\-salt\fR \fInum\fR
Seed for the pseudo random number generator (used e.g. for sequence shuffle generation and MCMC sampling).
Set this to get reproducible results.
.SS "MCMC optimization options:"
.TP
\fB\-\-temp\fR \fIfloat\fR (=0.001)
When performing MCMC sampling use this temperature.
The temperatures of parallel chains is decreasing by factors of two.
.TP
\fB\-\-maxiter\fR \fInum\fR (=1000)
Maximal number of iterations to perform during MCMC seeding.
.TP
\fB\-\-partemp\fR \fInum\fR (=6)
Parallel chains to run for parallel tempering.
.SS "Sequence logo creation options:"
.TP
\fB\-\-pdf\fR
Generate PDF files with sequence logos of the found motifs.
.TP
\fB\-\-png\fR
Generate PDF files with sequence logos of the found motifs.
.TP
\fB\-\-axes\fR
Include axes in sequence logos.
.TP
\fB\-\-logo\fR \fIarg\fR (=info)
Which kind of logo to create; 'info' for information\-type sequence logo (position height scaled by information content), 'freq' for frequency logo.
.TP
\fB\-\-alphabet\fR \fIarg\fR
Which alphabet to use; can be either 'RNA' or 'DNA'.
If left unspecified, 'DNA' is chosen if \fB\-\-revcomp\fR is used, and 'RNA' otherwise.
.TP
\fB\-\-order\fR \fIarg\fR (=freq)
How to vertically order the nucleotides; can be either \&'alpha' for alphabetic order or 'freq' for most frequent at top.
.TP
\fB\-\-pal\fR \fIarg\fR (=default)
Color palette to use; available are 'default', \&'solarized', 'tetrad'.
.TP
\fB\-\-scale\fR \fInum\fR (=100)
Height in pixels of the nucleotide stacks in the sequence logos.
.TP
\fB\-\-absent\fR \fIfloat\fR (=0.03)
Use this frequency for absent nucleotides when creating logos for IUPAC regular expression motifs.
.SH EXAMPLE
Some example calls:
.IP
plasma signal.fa \fB\-m\fR 8 > analysis.txt
.IP
plasma signal.fa control.fa \fB\-m\fR 8 > analysis.txt
.IP
plasma signal.fa control.fa \fB\-m\fR 4\-12 > analysis.txt
.IP
plasma signal.fa control.fa \fB\-m\fR 4\-12 \fB\-d\fR 0 > analysis.txt
.IP
plasma signal.fa control.fa \fB\-m\fR 4\-12 \fB\-\-score\fR freq \fB\-d\fR 0 > analysis.txt
.IP
plasma signal.fa control.fa \fB\-m\fR 4\-12 \fB\-\-score\fR freq \fB\-d\fR 2 > analysis.txt
.IP
plasma signal.fa control.fa \fB\-m\fR 4\-12 \fB\-d\fR 2 > analysis.txt
.IP
plasma signal.fa control.fa \fB\-m\fR 4\-12 \fB\-\-rdeg\fR 0.2 > analysis.txt
.IP
plasma signal:signal.fa control.fa \fB\-m\fR signal:8 > analysis.txt
.SH "SEE ALSO"
As part of the Discrover package a PDF manual should have been installed on your system.
You should find it at:
.IP
.I /usr/share/doc/discrover/discrover-manual.pdf
.PP
